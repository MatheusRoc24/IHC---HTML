<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="padrao.css">

    <title>Confeitaria</title>
  </head>
  <body>
    <header>
      <div>
        <h1>Confeitaria Sempre Doce</h1>
        <nav>
          <ul>
            <li>Início</li>
            <li>Sobre</li>
            <li>
              <a class="link" href="cardapio.html">Cardápio</a>
            </li>
            <li>Contato</li>
          </ul>
        </nav>
      </div>
    </header>
    
    <div>
      <img src="https://www.comidaereceitas.com.br/img/sizeswp/1200x675/2020/05/bolo_chocolate_leite.jpg" alt="Imagem de bolo"/>
    </div>

    <div class="sobre-nos">
      <h2 style="font-size: 25px;">Sobre Nós</h2>
      <p class="paragrafo-texto">
        Somos a confeitaria sempre doce dedicada a criar bolos
        deliciosos e personalizados para todas as ocasiões.
        Nossa paixão pela confeitaria é refletida em cada
        criação que sai da nossa cozinha.
      </p>
    </div>

    <div class="sobre-nos">
      <h2 style="font-size: 25px;">Nosso Cardápio</h2>
      <div class="itens-cardapio">

        <div class="item-cardapio">
          <h3>Bolo de Morango</h3>
          <p class="descricao">
            Fresco e frutado, perfeito para
            qualquer ocasião
          </p>
          <img class="img-item" src="https://www.comidaereceitas.com.br/img/sizeswp/1200x675/2020/05/bolo_chocolate_leite.jpg" />
        </div>

        <div class="item-cardapio">
          <h3>Bolo de Cenoura</h3>
          <p class="descricao">
            Uma delícia tradicional com 
            cobertura de chocolate.
          </p>
          <img class="img-item" src="https://www.comidaereceitas.com.br/img/sizeswp/1200x675/2020/05/bolo_chocolate_leite.jpg" />
        </div>

      </div>

      <!-- Seção para exibir dados da API e botão de atualização (movida para dentro do cardápio) -->
      <section class="api-section">
        <h3>Dados da API</h3>
        <button id="api-refresh" class="api-refresh-btn">Atualizar dados</button>
        <pre id="api-data" class="api-data">Carregando...</pre>
      </section>
    </div>
    
    <!-- API section moved inside cardapio -->

    <footer>
      <p>
        &copy; 2025 Confeitaria Sempre Doce.
        Todos os direitos reservados.
      </p>
    </footer>
    
    <script src="cardapio.js"></script>

    <script>
      // Faz uma requisição GET esperando JSON e atualiza o elemento #api-data
      async function fetchApi() {
        const output = document.getElementById('api-data');
        output.textContent = 'Carregando...';
        try {
          const res = await fetch('https://ihc-html.onrender.com', {
            method: 'GET',
            mode: 'cors',
            headers: {
              'Accept': 'application/json'
            }
          });

          if (!res.ok) throw new Error('Resposta não OK: ' + res.status);

          const contentType = res.headers.get('content-type') || '';
          if (contentType.includes('application/json')) {
            const data = await res.json();
            output.textContent = JSON.stringify(data, null, 2);

            // Tenta extrair a lista de itens do JSON (vários formatos possíveis)
            let items = null;
            if (Array.isArray(data)) items = data;
            else if (Array.isArray(data.items)) items = data.items;
            else if (Array.isArray(data.data)) items = data.data;
            else if (Array.isArray(data.produtos)) items = data.produtos;
            else if (Array.isArray(data.cardapio)) items = data.cardapio;
            else items = data;

            // Se existir a função de renderização, chama para popular o cardápio
            if (window.renderCardapio) {
              try {
                window.renderCardapio(items);
              } catch (e) {
                console.warn('Erro ao renderizar cardápio:', e);
              }
            }
          } else {
            const text = await res.text();
            output.textContent = text;
          }
        } catch (err) {
          output.textContent = 'Erro ao consultar API: ' + err.message;
          console.error(err);
        }
      }

      document.getElementById('api-refresh').addEventListener('click', fetchApi);

      // Busca inicial
      fetchApi();
    </script>
  </body>
</html>